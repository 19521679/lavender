{"version":3,"file":"embla-carousel-autoplay.js","sources":["src/components/Options.ts","src/components/index.ts"],"sourcesContent":["export type OptionsType = {\n  delay: number\n  stopOnInteraction: boolean\n  stopOnMouseEnter: boolean\n  stopOnLastSnap: boolean\n}\n\nexport const defaultOptions: OptionsType = {\n  delay: 4000,\n  stopOnInteraction: true,\n  stopOnMouseEnter: false,\n  stopOnLastSnap: false,\n}\n\nexport type AutoplayOptionsType = Partial<OptionsType>\n","import { defaultOptions, AutoplayOptionsType, OptionsType } from './Options'\nimport { EmblaCarouselType, EmblaPluginType } from 'embla-carousel'\n\nexport type AutoplayType = EmblaPluginType<OptionsType> & {\n  play: () => void\n  stop: () => void\n  reset: () => void\n}\n\nfunction Autoplay(\n  userOptions?: AutoplayOptionsType,\n  userNode?: (emblaRoot: HTMLElement) => HTMLElement | null,\n): AutoplayType {\n  const options = Object.assign({}, defaultOptions, userOptions)\n  const { stopOnInteraction, stopOnMouseEnter, stopOnLastSnap, delay } = options\n  let carousel: EmblaCarouselType\n  let mouseEntered = false\n  let timer = 0\n\n  function init(embla: EmblaCarouselType): void {\n    carousel = embla\n    const { eventStore } = carousel.internalEngine()\n    const emblaRoot = carousel.rootNode()\n    const root = (userNode && userNode(emblaRoot)) || emblaRoot\n\n    carousel.on('init', play)\n    carousel.on('pointerDown', stop)\n    carousel.on('pointerUp', reset)\n\n    if (stopOnMouseEnter) {\n      eventStore.add(root, 'mouseenter', () => {\n        mouseEntered = true\n        stop()\n      })\n      eventStore.add(root, 'mouseleave', () => {\n        mouseEntered = false\n        reset()\n      })\n    }\n  }\n\n  function destroy(): void {\n    carousel.off('init', play)\n    carousel.off('pointerDown', stop)\n    carousel.off('pointerUp', reset)\n    mouseEntered = false\n    stop()\n  }\n\n  function play(): void {\n    stop()\n    requestAnimationFrame(() => {\n      timer = window.setTimeout(next, delay)\n    })\n  }\n\n  function stop(): void {\n    if (!timer) return\n    window.clearTimeout(timer)\n    timer = 0\n  }\n\n  function reset(): void {\n    stop()\n    if (stopOnMouseEnter && mouseEntered) return\n    if (!stopOnInteraction) play()\n  }\n\n  function next(): void {\n    const { index } = carousel.internalEngine()\n    const proceed = index.get() !== index.max || !stopOnLastSnap\n\n    if (!proceed) return\n\n    if (carousel.canScrollNext()) {\n      carousel.scrollNext()\n    } else {\n      carousel.scrollTo(0)\n    }\n    play()\n  }\n\n  const self: AutoplayType = {\n    name: 'Autoplay',\n    options,\n    init,\n    destroy,\n    play,\n    stop,\n    reset,\n  }\n  return self\n}\n\nexport default Autoplay\n"],"names":["defaultOptions","delay","stopOnInteraction","stopOnMouseEnter","stopOnLastSnap","Autoplay","userOptions","userNode","options","Object","assign","carousel","mouseEntered","timer","init","embla","eventStore","internalEngine","emblaRoot","rootNode","root","on","play","stop","reset","add","destroy","off","requestAnimationFrame","window","setTimeout","next","clearTimeout","index","proceed","get","max","canScrollNext","scrollNext","scrollTo","self","name"],"mappings":"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"}